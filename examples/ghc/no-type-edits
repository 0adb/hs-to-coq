skip module TyCoRep
skip module Coercion
skip module CoAxiom
skip module Type
skip module Unify
skip module TcType
skip module TysWiredIn
skip module RepType


#
# This must stay in sync with the Makefile
#
rename module Class   Core
rename module TyCon   Core
rename module DataCon Core
rename module Var     Core
rename module IdInfo  Core
rename module PatSyn  Core
rename module VarSet  Core
rename module VarEnv  Core
rename module CoreSyn Core

# 
# These are notation (synonyms). So Core must be imported when they are.
# Instead it is easier to define them as their defns.
#

# rename type Var.Id    = Core.Var
# rename type Var.TyVar = Core.Var


#
# Punned constructor values
#
rename value DataCon.HsSrcBang  = Core.Mk_HsSrcBang
rename value DataCon.EqSpec     = Core.Mk_EqSpec
rename value Class.Class        = Core.Mk_Class
rename value Var.Id             = Core.Mk_Id
rename value Var.TyVar          = Core.Mk_TyVar
rename value Var.TcTyVar        = Core.Mk_TcTyVar
rename value IdInfo.IdInfo      = Core.Mk_IdInfo

rename value IdInfo.DFunId      = Core.Mk_DFunId
rename value IdInfo.JoinId      = Core.Mk_JoinId

rename value CoreSyn.Var        = Core.Mk_Var

## CallStack
rewrite forall x, Core.idInfo x = @Core.idInfo tt x

### get rid of some information in the AST
rename type PrimOp.PrimOp           = unit
rename type ForeignCall.ForeignCall = unit
rename type ForeignCall.CType       = unit

## Punning

rename value CoreSyn.IsOrphan  = Core.Mk_IsOrphan
rename value CoreSyn.RuleEnv   = Core.Mk_RuleEnv
rename value CoreFVs.FVAnn     = CoreFVs.Mk_FVAnn
rename value CoreSubst.Subst   = CoreSubst.Mk_Subst

rename value Demand.ExnStr = Demand.Mk_ExnStr
rename value Demand.Str = Demand.Mk_Str
rename value Demand.Use = Demand.Mk_Use
rename value Demand.DmdType = Demand.Mk_DmdType
rename value Demand.StrictSig = Demand.Mk_StrictSig
rename value Demand.KillFlags = Demand.Mk_KillFlags



###############################################################################
#
# IdInfo  --- edit out demandInfo, unfoldingIndo, ruleInfo, strictnessInfo from 
#             this data structure
#
rewrite forall x, Core.zapUsageEnvInfo x = x
rewrite forall x, Core.zapUsageInfo x    = x
rewrite forall x, Core.zapUsedOnceInfo x = x
rewrite forall x, Core.zapDemandInfo x   = x 

rewrite forall x, Core.setStrictnessInfo x = x
rewrite forall x, Core.setUnfoldingInfo  x = x
rewrite forall x, Core.setDemandInfo     x = x

rewrite forall arg dmd, Core.setDemandInfo arg dmd = arg
rewrite forall arg dmd, Core.setStrictnessInfo arg dmd = arg
rewrite forall arg dmd, Core.setUnfoldingInfo arg dmd = arg

rewrite forall x, Core.ruleInfoFreeVars x = FV.emptyFVs

rewrite forall x, Core.unfoldInfo x = tt

rewrite forall x, Core.sel_tycon x = tt

#
# Id -- 
#
rewrite forall arg y, Id.setIdUnfolding arg y = arg
rewrite forall x, Id.idType x = tt


###############################################################################


# bruttaly skipping all type info
### get rid of type information in the AST

rename type TcType.TcTyVarDetails = unit
redefine Definition Core.tcTyVarDetails : TyVar -> unit := fun x => tt.

# type used in DataCon
rename type MkId.DataConBoxer = unit

rename type TyCoRep.Coercion      = unit
rename type TyCoRep.Type_         = unit
rename type TyCoRep.ThetaType     = unit
rename type TyCoRep.TyBinder      = unit
rename type TyCoRep.TyThing       = unit
rename type TyCoRep.Kind          = unit
rename type TyCoRep.PredType      = unit

rename type TyCoRep.TvSubstEnv    = unit
rename type TyCoRep.CvSubstEnv    = unit
rename type TyCoRep.TCvSubst      = unit

rename type CoAxiom.CoAxiom = list
rename type CoAxiom.Branched = unit
rename type CoAxiom.Unbranched = unit
rename type CoAxiom.BuiltInSynFamily = unit
rename type CoAxiom.Role = unit
rename value CoAxiom.Representational = tt
rename value CoAxiom.Nominal = tt
rename value TysWiredIn.liftedTypeKind = tt
rename value TysWiredIn.constraintKind = tt

## Could make these unit too.
redefine Inductive TyCon.RuntimeRepInfo     : Type := TyCon.Mk_RuntimeRepInfo_Dummy.
redefine Inductive MkId.DataConBoxer        : Type := MkId.Mk_DataConBoxer_Dummy.
redefine Inductive CoAxiom.CoAxiomRule      : Type := CoAxiom.Mk_CoAxiomRule_Dummy.
redefine Inductive CoAxiom.BuiltInSynFamily : Type := CoAxiom.Mk_BuiltInSynFamily_Dummy.

## rewrite things that are unit to tt

# rewrite forall x, Core.mkTyArg x = Core.Type_ tt
rewrite forall x, TyCoRep.mkTyVarTy x = tt
rewrite forall v, Coercion.mkCoVarCo v = tt
rewrite forall rhs, CoreUtils.exprType rhs = tt

rewrite forall x, TyCoRep.isCoercionType x = false


#
rewrite forall var,    Core.isTyCoVar var = false
rewrite forall env x,  TyCoRep.tidyType env x = tt
rewrite forall env co, TyCoRep.tidyCo env co = tt

#
# No unfolding / rules in IdInfo
#
rewrite forall x, CoreSyn.isEvaldUnfolding x = false
rewrite forall x, Core.isStableUnfolding x = false
